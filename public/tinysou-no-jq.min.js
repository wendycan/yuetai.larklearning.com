!function(a){var b=null;a.modal=function(c,d){a.modal.close();var e,f;if(this.$body=a("body"),this.options=a.extend({},a.modal.defaults,d),this.options.doFade=!isNaN(parseInt(this.options.fadeDuration,10)),c.is("a"))if(f=c.attr("href"),/^#/.test(f)){if(this.$elm=a(f),1!==this.$elm.length)return null;this.open()}else this.$elm=a("<div>"),this.$body.append(this.$elm),e=function(a,b){b.elm.remove()},this.showSpinner(),c.trigger(a.modal.AJAX_SEND),a.get(f).done(function(d){b&&(c.trigger(a.modal.AJAX_SUCCESS),b.$elm.empty().append(d).on(a.modal.CLOSE,e),b.hideSpinner(),b.open(),c.trigger(a.modal.AJAX_COMPLETE))}).fail(function(){c.trigger(a.modal.AJAX_FAIL),b.hideSpinner(),c.trigger(a.modal.AJAX_COMPLETE)});else this.$elm=c,this.open()},a.modal.prototype={constructor:a.modal,open:function(){var b=this;this.options.doFade?(this.block(),setTimeout(function(){b.show()},this.options.fadeDuration*this.options.fadeDelay)):(this.block(),this.show()),this.options.escapeClose&&a(document).on("keydown.modal",function(b){27==b.which&&a.modal.close()}),this.options.clickClose&&this.blocker.click(a.modal.close)},close:function(){this.unblock(),this.hide(),a(document).off("keydown.modal")},block:function(){var b=this.options.doFade?0:this.options.opacity;this.$elm.trigger(a.modal.BEFORE_BLOCK,[this._ctx()]),this.blocker=a('<div class="jquery-modal blocker"></div>').css({top:0,right:0,bottom:0,left:0,width:"100%",height:"100%",position:"fixed",zIndex:this.options.zIndex,background:this.options.overlay,opacity:b}),this.$body.append(this.blocker),this.options.doFade&&this.blocker.animate({opacity:this.options.opacity},this.options.fadeDuration),this.$elm.trigger(a.modal.BLOCK,[this._ctx()])},unblock:function(){this.options.doFade?this.blocker.fadeOut(this.options.fadeDuration,function(){a(this).remove()}):this.blocker.remove()},show:function(){this.$elm.trigger(a.modal.BEFORE_OPEN,[this._ctx()]),this.options.showClose&&(this.closeButton=a('<a href="#close-modal" rel="modal:close" class="close-modal '+this.options.closeClass+'">'+this.options.closeText+"</a>"),this.$elm.append(this.closeButton)),this.$elm.addClass(this.options.modalClass+" current"),this.center(),this.options.doFade?this.$elm.fadeIn(this.options.fadeDuration):this.$elm.show(),this.$elm.trigger(a.modal.OPEN,[this._ctx()])},hide:function(){this.$elm.trigger(a.modal.BEFORE_CLOSE,[this._ctx()]),this.closeButton&&this.closeButton.remove(),this.$elm.removeClass("current"),this.options.doFade?this.$elm.fadeOut(this.options.fadeDuration):this.$elm.hide(),this.$elm.trigger(a.modal.CLOSE,[this._ctx()])},showSpinner:function(){this.options.showSpinner&&(this.spinner=this.spinner||a('<div class="'+this.options.modalClass+'-spinner"></div>').append(this.options.spinnerHtml),this.$body.append(this.spinner),this.spinner.show())},hideSpinner:function(){this.spinner&&this.spinner.remove()},center:function(){this.$elm.css({position:"fixed",top:"50%",left:"50%",marginTop:-(this.$elm.outerHeight()/2),marginLeft:-(this.$elm.outerWidth()/2),zIndex:this.options.zIndex+1})},_ctx:function(){return{elm:this.$elm,blocker:this.blocker,options:this.options}}},a.modal.prototype.resize=a.modal.prototype.center,a.modal.close=function(a){if(b){a&&a.preventDefault(),b.close();var c=b.$elm;return b=null,c}},a.modal.resize=function(){b&&b.resize()},a.modal.isActive=function(){return b?!0:!1},a.modal.defaults={overlay:"#000",opacity:.75,zIndex:1,escapeClose:!0,clickClose:!0,closeText:"Close",closeClass:"",modalClass:"modal",spinnerHtml:null,showSpinner:!0,showClose:!0,fadeDuration:null,fadeDelay:1},a.modal.BEFORE_BLOCK="modal:before-block",a.modal.BLOCK="modal:block",a.modal.BEFORE_OPEN="modal:before-open",a.modal.OPEN="modal:open",a.modal.BEFORE_CLOSE="modal:before-close",a.modal.CLOSE="modal:close",a.modal.AJAX_SEND="modal:ajax:send",a.modal.AJAX_SUCCESS="modal:ajax:success",a.modal.AJAX_FAIL="modal:ajax:fail",a.modal.AJAX_COMPLETE="modal:ajax:complete",a.fn.modal=function(c){return 1===this.length&&(b=new a.modal(this,c)),this},a(document).on("click.modal",'a[rel="modal:close"]',a.modal.close),a(document).on("click.modal",'a[rel="modal:open"]',function(b){b.preventDefault(),a(this).modal()})}(jQuery);var Hogan={};!function(a){function b(a,b,c){var d;return b&&"object"==typeof b&&(null!=b[a]?d=b[a]:c&&b.get&&"function"==typeof b.get&&(d=b.get(a))),d}function c(a,b,c,d,e,f){function g(){}function h(){}g.prototype=a,h.prototype=a.subs;var i,j=new g;j.subs=new h,j.subsText={},j.buf="",d=d||{},j.stackSubs=d,j.subsText=f;for(i in b)d[i]||(d[i]=b[i]);for(i in d)j.subs[i]=d[i];e=e||{},j.stackPartials=e;for(i in c)e[i]||(e[i]=c[i]);for(i in e)j.partials[i]=e[i];return j}function d(a){return String(null===a||void 0===a?"":a)}function e(a){return a=d(a),k.test(a)?a.replace(f,"&amp;").replace(g,"&lt;").replace(h,"&gt;").replace(i,"&#39;").replace(j,"&quot;"):a}a.Template=function(a,b,c,d){a=a||{},this.r=a.code||this.r,this.c=c,this.options=d||{},this.text=b||"",this.partials=a.partials||{},this.subs=a.subs||{},this.buf=""},a.Template.prototype={r:function(){return""},v:e,t:d,render:function(a,b,c){return this.ri([a],b||{},c)},ri:function(a,b,c){return this.r(a,b,c)},ep:function(a,b){var d=this.partials[a],e=b[d.name];if(d.instance&&d.base==e)return d.instance;if("string"==typeof e){if(!this.c)throw new Error("No compiler available.");e=this.c.compile(e,this.options)}if(!e)return null;if(this.partials[a].base=e,d.subs){b.stackText||(b.stackText={});for(key in d.subs)b.stackText[key]||(b.stackText[key]=void 0!==this.activeSub&&b.stackText[this.activeSub]?b.stackText[this.activeSub]:this.text);e=c(e,d.subs,d.partials,this.stackSubs,this.stackPartials,b.stackText)}return this.partials[a].instance=e,e},rp:function(a,b,c,d){var e=this.ep(a,c);return e?e.ri(b,c,d):""},rs:function(a,b,c){var d=a[a.length-1];if(!l(d))return void c(a,b,this);for(var e=0;e<d.length;e++)a.push(d[e]),c(a,b,this),a.pop()},s:function(a,b,c,d,e,f,g){var h;return l(a)&&0===a.length?!1:("function"==typeof a&&(a=this.ms(a,b,c,d,e,f,g)),h=!!a,!d&&h&&b&&b.push("object"==typeof a?a:b[b.length-1]),h)},d:function(a,c,d,e){var f,g=a.split("."),h=this.f(g[0],c,d,e),i=this.options.modelGet,j=null;if("."===a&&l(c[c.length-2]))h=c[c.length-1];else for(var k=1;k<g.length;k++)f=b(g[k],h,i),null!=f?(j=h,h=f):h="";return e&&!h?!1:(e||"function"!=typeof h||(c.push(j),h=this.mv(h,c,d),c.pop()),h)},f:function(a,c,d,e){for(var f=!1,g=null,h=!1,i=this.options.modelGet,j=c.length-1;j>=0;j--)if(g=c[j],f=b(a,g,i),null!=f){h=!0;break}return h?(e||"function"!=typeof f||(f=this.mv(f,c,d)),f):e?!1:""},ls:function(a,b,c,e,f){var g=this.options.delimiters;return this.options.delimiters=f,this.b(this.ct(d(a.call(b,e)),b,c)),this.options.delimiters=g,!1},ct:function(a,b,c){if(this.options.disableLambda)throw new Error("Lambda features disabled.");return this.c.compile(a,this.options).render(b,c)},b:function(a){this.buf+=a},fl:function(){var a=this.buf;return this.buf="",a},ms:function(a,b,c,d,e,f,g){var h,i=b[b.length-1],j=a.call(i);return"function"==typeof j?d?!0:(h=this.activeSub&&this.subsText&&this.subsText[this.activeSub]?this.subsText[this.activeSub]:this.text,this.ls(j,i,c,h.substring(e,f),g)):j},mv:function(a,b,c){var e=b[b.length-1],f=a.call(e);return"function"==typeof f?this.ct(d(f.call(e)),e,c):f},sub:function(a,b,c,d){var e=this.subs[a];e&&(this.activeSub=a,e(b,c,this,d),this.activeSub=!1)}};var f=/&/g,g=/</g,h=/>/g,i=/\'/g,j=/\"/g,k=/[&<>\"\']/,l=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}}("undefined"!=typeof exports?exports:Hogan),function(a){function b(a){"}"===a.n.substr(a.n.length-1)&&(a.n=a.n.substring(0,a.n.length-1))}function c(a){return a.trim?a.trim():a.replace(/^\s*|\s*$/g,"")}function d(a,b,c){if(b.charAt(c)!=a.charAt(0))return!1;for(var d=1,e=a.length;e>d;d++)if(b.charAt(c+d)!=a.charAt(d))return!1;return!0}function e(b,c,d,h){var i=[],j=null,k=null,l=null;for(k=d[d.length-1];b.length>0;){if(l=b.shift(),k&&"<"==k.tag&&!(l.tag in t))throw new Error("Illegal content in < super tag.");if(a.tags[l.tag]<=a.tags.$||f(l,h))d.push(l),l.nodes=e(b,l.tag,d,h);else{if("/"==l.tag){if(0===d.length)throw new Error("Closing tag without opener: /"+l.n);if(j=d.pop(),l.n!=j.n&&!g(l.n,j.n,h))throw new Error("Nesting error: "+j.n+" vs. "+l.n);return j.end=l.i,i}"\n"==l.tag&&(l.last=0==b.length||"\n"==b[0].tag)}i.push(l)}if(d.length>0)throw new Error("missing closing tag: "+d.pop().n);return i}function f(a,b){for(var c=0,d=b.length;d>c;c++)if(b[c].o==a.n)return a.tag="#",!0}function g(a,b,c){for(var d=0,e=c.length;e>d;d++)if(c[d].c==a&&c[d].o==b)return!0}function h(a){var b=[];for(var c in a)b.push('"'+j(c)+'": function(c,p,t,i) {'+a[c]+"}");return"{ "+b.join(",")+" }"}function i(a){var b=[];for(var c in a.partials)b.push('"'+j(c)+'":{name:"'+j(a.partials[c].name)+'", '+i(a.partials[c])+"}");return"partials: {"+b.join(",")+"}, subs: "+h(a.subs)}function j(a){return a.replace(s,"\\\\").replace(p,'\\"').replace(q,"\\n").replace(r,"\\r")}function k(a){return~a.indexOf(".")?"d":"f"}function l(a,b){var c="<"+(b.prefix||""),d=c+a.n+u++;return b.partials[d]={name:a.n,partials:{}},b.code+='t.b(t.rp("'+j(d)+'",c,p,"'+(a.indent||"")+'"));',d}function m(a,b){b.code+="t.b(t.t(t."+k(a.n)+'("'+j(a.n)+'",c,p,0)));'}function n(a){return"t.b("+a+");"}var o=/\S/,p=/\"/g,q=/\n/g,r=/\r/g,s=/\\/g;a.tags={"#":1,"^":2,"<":3,$:4,"/":5,"!":6,">":7,"=":8,_v:9,"{":10,"&":11,_t:12},a.scan=function(e,f){function g(){s.length>0&&(t.push({tag:"_t",text:new String(s)}),s="")}function h(){for(var b=!0,c=w;c<t.length;c++)if(b=a.tags[t[c].tag]<a.tags._v||"_t"==t[c].tag&&null===t[c].text.match(o),!b)return!1;return b}function i(a,b){if(g(),a&&h())for(var c,d=w;d<t.length;d++)t[d].text&&((c=t[d+1])&&">"==c.tag&&(c.indent=t[d].text.toString()),t.splice(d,1));else b||t.push({tag:"\n"});u=!1,w=t.length}function j(a,b){var d="="+y,e=a.indexOf(d,b),f=c(a.substring(a.indexOf("=",b)+1,e)).split(" ");return x=f[0],y=f[f.length-1],e+d.length-1}var k=e.length,l=0,m=1,n=2,p=l,q=null,r=null,s="",t=[],u=!1,v=0,w=0,x="{{",y="}}";for(f&&(f=f.split(" "),x=f[0],y=f[1]),v=0;k>v;v++)p==l?d(x,e,v)?(--v,g(),p=m):"\n"==e.charAt(v)?i(u):s+=e.charAt(v):p==m?(v+=x.length-1,r=a.tags[e.charAt(v+1)],q=r?e.charAt(v+1):"_v","="==q?(v=j(e,v),p=l):(r&&v++,p=n),u=v):d(y,e,v)?(t.push({tag:q,n:c(s),otag:x,ctag:y,i:"/"==q?u-x.length:v+y.length}),s="",v+=y.length-1,p=l,"{"==q&&("}}"==y?v++:b(t[t.length-1]))):s+=e.charAt(v);return i(u,!0),t};var t={_t:!0,"\n":!0,$:!0,"/":!0};a.stringify=function(b){return"{code: function (c,p,i) { "+a.wrapMain(b.code)+" },"+i(b)+"}"};var u=0;a.generate=function(b,c,d){u=0;var e={code:"",subs:{},partials:{}};return a.walk(b,e),d.asString?this.stringify(e,c,d):this.makeTemplate(e,c,d)},a.wrapMain=function(a){return'var t=this;t.b(i=i||"");'+a+"return t.fl();"},a.template=a.Template,a.makeTemplate=function(a,b,c){var d=this.makePartials(a);return d.code=new Function("c","p","i",this.wrapMain(a.code)),new this.template(d,b,this,c)},a.makePartials=function(a){var b,c={subs:{},partials:a.partials,name:a.name};for(b in c.partials)c.partials[b]=this.makePartials(c.partials[b]);for(b in a.subs)c.subs[b]=new Function("c","p","t","i",a.subs[b]);return c},a.codegen={"#":function(b,c){c.code+="if(t.s(t."+k(b.n)+'("'+j(b.n)+'",c,p,1),c,p,0,'+b.i+","+b.end+',"'+b.otag+" "+b.ctag+'")){t.rs(c,p,function(c,p,t){',a.walk(b.nodes,c),c.code+="});c.pop();}"},"^":function(b,c){c.code+="if(!t.s(t."+k(b.n)+'("'+j(b.n)+'",c,p,1),c,p,1,0,0,"")){',a.walk(b.nodes,c),c.code+="};"},">":l,"<":function(b,c){var d={partials:{},code:"",subs:{},inPartial:!0};a.walk(b.nodes,d);var e=c.partials[l(b,c)];e.subs=d.subs,e.partials=d.partials},$:function(b,c){var d={subs:{},code:"",partials:c.partials,prefix:b.n};a.walk(b.nodes,d),c.subs[b.n]=d.code,c.inPartial||(c.code+='t.sub("'+j(b.n)+'",c,p,i);')},"\n":function(a,b){b.code+=n('"\\n"'+(a.last?"":" + i"))},_v:function(a,b){b.code+="t.b(t.v(t."+k(a.n)+'("'+j(a.n)+'",c,p,0)));'},_t:function(a,b){b.code+=n('"'+j(a.text)+'"')},"{":m,"&":m},a.walk=function(b,c){for(var d,e=0,f=b.length;f>e;e++)d=a.codegen[b[e].tag],d&&d(b[e],c);return c},a.parse=function(a,b,c){return c=c||{},e(a,"",[],c.sectionTags||[])},a.cache={},a.cacheKey=function(a,b){return[a,!!b.asString,!!b.disableLambda,b.delimiters,!!b.modelGet].join("||")},a.compile=function(b,c){c=c||{};var d=a.cacheKey(b,c),e=this.cache[d];if(e){var f=e.partials;for(var g in f)delete f[g].instance;return e}return e=this.generate(this.parse(this.scan(b,c.delimiters),b,c),b,c),this.cache[d]=e}}("undefined"!=typeof exports?exports:Hogan),function(a,b,c){"$:nomunge";function d(a){a=a||location.href;var b=a.indexOf("#");return-1===b?"#":a.substr(b)}var e,f="hashchange",g=document,h=a.event.special,i=g.documentMode,j="on"+f in b&&(i===c||i>7);a.fn[f]=function(a){return a?this.bind(f,a):this.trigger(f)},a.fn[f].delay=50,h[f]=a.extend(h[f],{setup:function(){return j?!1:void a(e.start)},teardown:function(){return j?!1:void a(e.stop)}}),e=function(){function e(){var c=d(),g=n(k);c!==k?(m(k=c,g),a(b).trigger(f)):g!==k&&(location.href=location.href.replace(/#.*/,"")+g),h=setTimeout(e,a.fn[f].delay)}var h,i={},k=d(),l=function(a){return a},m=l,n=l;return i.start=function(){h||e()},i.stop=function(){h&&clearTimeout(h),h=c},b.attachEvent&&!b.addEventListener&&!j&&function(){var b,c;i.start=function(){b||(c=a.fn[f].src,c=c&&c+d(),b=a('<iframe tabindex="-1" title="empty"/>').hide().one("load",function(){c||m(d()),e()}).attr("src",c||"javascript:0").insertAfter("body")[0].contentWindow,g.onpropertychange=function(){try{"title"===event.propertyName&&(b.document.title=g.title)}catch(a){}})},i.stop=l,n=function(){return d(b.location.href)},m=function(c,d){var e=b.document,h=a.fn[f].domain;c!==d&&(e.title=g.title,e.open(),h&&e.write('<script>document.domain="'+h+'"</script>'),e.close(),b.location.hash=c)}}(),i}()}(jQuery,this),function(a){function b(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}function c(a){this.size=0,this.limit=a,this._keymap={}}var d=function(a){var b,c,d={};if(""===a)return{};for(b=0;b<a.length;b+=1)c=a[b].split("="),2===c.length&&(d[c[0]]=decodeURIComponent(c[1].replace(/\+/g," ")));return d};a.queryParams=function(){return d(window.location.search.substr(1).split("&"))},a.hashParams=function(){return d(window.location.hash.substr(1).split("&"))};var e=0;window.TinySou=window.TinySou||{},TinySou.root_url=TinySou.root_url||"https://api.swiftype.com",TinySou.pingUrl=function(a,b){var c=setTimeout(b,350),d=new Image;return d.onload=d.onerror=function(){clearTimeout(c),b()},d.src=a,!1},TinySou.pingSearchResultClick=function(b,c,d){var e={t:(new Date).getTime(),engine_key:b,doc_id:c,q:TinySou.currentQuery},f=TinySou.root_url+"/api/v1/public/analytics/pc?"+a.param(e);TinySou.pingUrl(f,d)},TinySou.pingAutoSelection=function(b,c,d,e){var f={t:(new Date).getTime(),engine_key:b,doc_id:c,prefix:d},g=TinySou.root_url+"/api/v1/public/analytics/pas?"+a.param(f);TinySou.pingUrl(g,e)},TinySou.findSelectedSection=function(){function b(a){var b=a.replace(/\s+/g,"");return b=b.toLowerCase()}var c=a.hashParams().sts;c&&(c=b(c),a("h1, h2, h3, h4, h5, h6").each(function(){return $this=a(this),b($this.text()).indexOf(c)>=0?(this.scrollIntoView(!0),!1):void 0}))},TinySou.htmlEscape=TinySou.htmlEscape||function(a){return String(a).replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},a.fn.tinysouSearch=function(b){var b=a.extend({},a.fn.tinysouSearch.defaults,b);return this.each(function(){var d=a(this),f=a.meta?a.extend({},b,d.data()):b;d.data("tinysou-config-search",f),d.selectedCallback=function(b){return function(c){var d=a(this);c.preventDefault(),TinySou.pingSearchResultClick(f.engineKey,b.id,function(){window.location=d.attr("href")})}},d.selectedAtcCallback=function(a){return function(){var b=d.val(),c=function(){f.onComplete(a,b)};TinySou.pingAutoSelection(f.engineKey,a.id,b,c)}},d.registerResult=function(b,c){b.data("tinysou-item",c),a("a",b).click(d.selectedCallback(c))},d.registerActResult=function(a,b){a.data("tinysou-item",b),a.click(d.selectedAtcCallback(b)).mouseover(function(){d.listResults().removeClass(f.activeItemClass),a.addClass(f.activeItemClass)})},d.abortCurrent=function(){d.currentRequest&&d.currentRequest.abort()},d.showList=function(){u(f.disableAutocomplete)===!1&&t.show()},d.hideList=function(a){a?t.hide():setTimeout(function(){t.hide()},10)},d.focused=function(){return d.is(":focus")},d.submitting=function(){d.submitted=!0},d.listResults=function(){return a(f.resultListSelector,v)},d.activeResult=function(){return d.listResults().filter("."+f.activeItemClass).first()},d.prevResult=function(){var a=d.listResults(),b=a.index(d.activeResult()),c=b-1,e=a.eq(c);d.listResults().removeClass(f.activeItemClass),c>=0&&e.addClass(f.activeItemClass)},d.nextResult=function(){var a=d.listResults(),b=a.index(d.activeResult()),c=b+1,e=a.eq(c);d.listResults().removeClass(f.activeItemClass),c>=0&&e.addClass(f.activeItemClass)},d.styleDropdown=function(){t.css(f.dropdownStylesFunction(d))},a(window).resize(function(){d.styleDropdown()}),d.isEmpty=function(b){return a.inArray(g(b),this.emptyQueries)>=0},d.addEmpty=function(a){d.emptyQueries.unshift(g(a))},d.getContentCache=function(){return a("#"+l)};var h;if("inline"==f.renderStyle)h=a(f.resultContainingElement);else if("new_page"==f.renderStyle){h=a(f.resultContainingElement);var i=window.location.toString().split("#")[0];i==f.resultPageURL&&(f.renderStyle="inline")}else a("body").append("<div id='st-results-container' style='display: none;'></div>"),h=a("#st-results-container");var k=h.html(),l="st-content-cache",m=d.getContentCache(),n=function(a,b){location.hash="stq="+encodeURIComponent(a)+"&stp="+b},o=function(b,c){function d(a){if(void 0!==a){var b=a;return"function"==typeof b&&(b=b.call()),b}return void 0}c=a.extend({page:1},c);var e={};m.length||(h.after("<div id='"+l+"' style='display: none;'></div>"),m.html(k).hide()),f.loadingFunction(b,h),TinySou.currentQuery=b,e.q=b,e.engine_key=f.engineKey,e.page=c.page,e.per_page=f.perPage,e.search_fields=d(f.searchFields),e.fetch_fields=d(f.fetchFields),e.facets=d(f.facets),e.filters=d(f.filters),e.document_types=d(f.documentTypes),e.functional_boosts=d(f.functionalBoosts),e.sort_field=d(f.sortField),e.sort_direction=d(f.sortDirection),e.spelling=d(f.spelling),a.getJSON(TinySou.root_url+"/api/v1/public/engines/search.json?callback=?",e).success(q)};a(window).hashchange(function(){var b=a.hashParams();if(b.stq)o(b.stq,{page:b.stp});else{var c=d.getContentCache();c.length&&(h.html(c.html()),c.remove())}});var p=d.parents("form");p&&p.bind("submit",function(a){a.preventDefault();var b=d.val();n(b,1)}),a(document).on("click","[data-hash][data-page]",function(b){b.preventDefault();var c=a(this);n(a.hashParams().stq,c.data("page"))}),a(document).on("click","[data-hash][data-spelling-suggestion]",function(b){b.preventDefault();var c=a(this);n(c.data("spelling-suggestion"),1)});var q=function(a){"function"==typeof f.preRenderFunction&&f.preRenderFunction.call(d,a),f.renderResultsFunction(d.getContext(),a),"function"==typeof f.postRenderFunction&&f.postRenderFunction.call(d,a)};d.getContext=function(){return{config:f,resultContainer:h,registerResult:d.registerResult}},d.getActContext=function(){return{config:f,list:v,registerActResult:d.registerActResult}},d.attr("autocomplete","off"),d.data("tinysou-config-autocomplete",f),d.submitted=!1,d.cache=new c(10),d.emptyQueries=[];var r=f.dropdownStylesFunction(d),s=a('<div class="tinysou-widget" />'),t=a("<div />").addClass(f.suggestionListClass).appendTo(s).css(r).hide();s.appendTo(f.autocompleteContainingElement);var v=a("<"+f.suggestionListType+" />").appendTo(t);d.data("tinysou-list",v);var w,x=!1;d.lastValue="",d.keyup(function(a){return x?void(x=!1):void(a.which>36&&a.which<41||16==a.which||(f.typingDelay>0?(clearTimeout(w),w=setTimeout(function(){j(d)},f.typingDelay)):j(d)))}),d.keydown(function(a){d.styleDropdown();var b=d.activeResult();switch(a.which){case 13:0!==b.length&&v.is(":visible")?(a.preventDefault(),d.selectedAtcCallback(b.data("tinysou-item"))()):d.currentRequest&&d.submitting(),d.hideList(),x=!0;break;case 38:a.preventDefault(),0===b.length?d.listResults().last().addClass(f.activeItemClass):d.prevResult();break;case 40:a.preventDefault(),0===b.length?d.listResults().first().addClass(f.activeItemClass):b!=d.listResults().last()&&d.nextResult();break;case 27:d.hideList(),x=!0;break;default:d.submitted=!1}}),d.keypress(function(a){13==a.which&&d.activeResult().length>0&&a.preventDefault()});var y=!1,z=!1;a(document).bind("mousedown.tinysou"+ ++e,function(){y=!0}),a(document).bind("mouseup.tinysou"+e,function(){y=!1,z&&(z=!1,d.hideList())}),d.blur(function(){y?z=!0:d.hideList()}),d.focus(function(){setTimeout(function(){d.select()},10),d.listResults().filter(":not(."+f.noResultsClass+")").length>0&&d.showList()}),a(window).hashchange()})};var f=function(b,c){var d,e=-1,f=b.config;a.each(c,function(a,b){b.num_pages>e&&(d=a,e=b.num_pages)});var g=c[d].current_page,h=c[d].num_pages;a(f.renderPaginationForType(d,g,h)).appendTo(b.resultContainer)},g=function(b){return a.trim(b).toLowerCase()},h=function(b,c){b.abortCurrent();var d={},e=b.data("tinysou-config-autocomplete");d.q=c,d.engine_key=e.engineKey,d.search_fields=u(e.searchFields),d.fetch_fields=u(e.fetchFields),d.filters=u(e.filters),d.document_types=u(e.documentTypes),d.functional_boosts=u(e.functionalBoosts),d.sort_field=u(e.sortField),d.sort_direction=u(e.sortDirection),d.per_page=e.resultLimit;var f=TinySou.root_url+"/api/v1/public/engines/suggest.json";b.currentRequest=a.ajax({type:"GET",dataType:"jsonp",url:f,data:d}).success(function(a){var d=g(c);return a.record_count>0?(b.cache.put(d,a.records),void k(b,a.records,c)):(b.addEmpty(d),b.data("tinysou-list").empty(),void b.hideList())})},i=function(a,b){var c=g(b);if(a.isEmpty(c))return a.data("tinysou-list").empty(),void a.hideList();var d=a.cache.get(c);d?k(a,d,b):h(a,b)},j=function(b){var c=b.val();if(c!==b.lastValue)return b.lastValue=c,""===a.trim(c)?(b.data("tinysou-list").empty(),void b.hideList()):void("undefined"!=typeof b.data("tinysou-config-autocomplete").engineKey&&i(b,c))},k=function(a,b){var c=a.data("tinysou-list"),d=a.data("tinysou-config-autocomplete");c.empty(),a.hideList(!0),d.renderActResultsFunction(a.getActContext(),b);var e=a.listResults().length;(e>0&&a.focused()||void 0!==d.noResultsMessage)&&(a.submitted?a.submitted=!1:a.showList())},l=function(b,c){var d=b.resultContainer,e=b.config;if(d.html(""),a.each(c.records,function(c,f){a.each(f,function(f,g){b.registerResult(a(e.renderFunction(c,g)).appendTo(d),g)})}),f(b,c.info),e.renderStyle){if("new_page"==e.renderStyle){var g=e.resultPageURL+window.location.hash;window.location.replace(g),e.renderStyle="inline",e.resultContainingElement="#st-results-container"}}else a("#st-results-container").appendTo("body").modal()},m=function(a,c){return'<div class="st-result"><h3 class="title"><a href="'+c.url+'" class="st-search-result-link">'+b(c.title)+"</a></h3></div>"},n=function(a,b){b.html('<p class="st-loading-message">loading...</p>')},o=function(b){var c=0,d=this.getContext().resultContainer,e=null;b.info&&a.each(b.info,function(a,b){c+=b.total_result_count,b.spelling_suggestion&&(e=b.spelling_suggestion.text)}),0===c&&d.html("<div id='st-no-results' class='st-no-results'>No results found.</div>"),null!==e&&d.append('<div class="st-spelling-suggestion">Did you mean <a href="#" data-hash="true" data-spelling-suggestion="'+e+'">'+e+"</a>?</div>")},p=function(a,b,c){var d,e,f='<div class="st-page">';return 1!=b&&(d=b-1,f=f+'<a href="#" class="st-prev" data-hash="true" data-page="'+d+'">&laquo; previous</a>'),c>b&&(e=b+1,f=f+'<a href="#" class="st-next" data-hash="true" data-page="'+e+'">next &raquo;</a>'),f+="</div>"},q=function(b,c){var d=b.list,e=b.config;a.each(c,function(c,f){a.each(f,function(f,g){b.registerActResult(a("<li>"+e.renderActFunction(c,g)+"</li>").appendTo(d),g)})})},r=function(a,b){return'<p class="title">'+TinySou.htmlEscape(b.title)+"</p>"},s=function(a){window.location=a.url},t=function(b){var c=b.data("tinysou-config-autocomplete"),d=c.attachTo?a(c.attachTo):b,e=d.offset(),f={position:"absolute","z-index":9999,top:e.top+d.outerHeight()+1,left:e.left};return c.setWidth&&(f.width=d.outerWidth()-2),f},u=function(a){if(void 0!==a){var b=a;return"function"==typeof b&&(b=b.call()),b}return void 0};c.prototype.put=function(a,b){var c={key:a,value:b};return this._keymap[a]=c,this.tail?(this.tail.newer=c,c.older=this.tail):this.head=c,this.tail=c,this.size===this.limit?this.shift():void this.size++},c.prototype.shift=function(){var a=this.head;return a&&(this.head.newer?(this.head=this.head.newer,this.head.older=void 0):this.head=void 0,a.newer=a.older=void 0,delete this._keymap[a.key]),a},c.prototype.get=function(a,b){var c=this._keymap[a];if(void 0!==c)return c===this.tail?c.value:(c.newer&&(c===this.head&&(this.head=c.newer),c.newer.older=c.older),c.older&&(c.older.newer=c.newer),c.newer=void 0,c.older=this.tail,this.tail&&(this.tail.newer=c),this.tail=c,b?c:c.value)},c.prototype.remove=function(a){var b=this._keymap[a];if(b)return delete this._keymap[b.key],b.newer&&b.older?(b.older.newer=b.newer,b.newer.older=b.older):b.newer?(b.newer.older=void 0,this.head=b.newer):b.older?(b.older.newer=void 0,this.tail=b.older):this.head=this.tail=void 0,this.size--,b.value},c.prototype.clear=function(){this.head=this.tail=void 0,this.size=0,this._keymap={}},c.prototype.keys="function"==typeof Object.keys?function(){return Object.keys(this._keymap)}:function(){var a=[];for(var b in this._keymap)a.push(b);return a},a.fn.tinysouSearch.defaults={attachTo:void 0,documentTypes:void 0,facets:void 0,filters:void 0,engineKey:void 0,searchFields:void 0,functionalBoosts:void 0,sortField:void 0,sortDirection:void 0,fetchFields:void 0,renderStyle:void 0,resultPageURL:void 0,resultContainingElement:void 0,preRenderFunction:void 0,postRenderFunction:o,loadingFunction:n,renderResultsFunction:l,renderFunction:m,renderPaginationForType:p,perPage:10,spelling:"strict",activeItemClass:"active",noResultsClass:"noResults",noResultsMessage:void 0,onComplete:s,renderActResultsFunction:q,renderActFunction:r,dropdownStylesFunction:t,resultLimit:void 0,suggestionListType:"ul",suggestionListClass:"autocomplete",resultListSelector:"li",setWidth:!0,typingDelay:80,disableAutocomplete:!1,autocompleteContainingElement:"body"}}(jQuery);
